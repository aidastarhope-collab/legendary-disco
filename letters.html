<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>üìú Briefe f√ºr dich</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
/* ===== Alles im Scope #gift-app, um Kollisionen zu vermeiden ===== */
#gift-app{
  --bg:#05353d;
  --wrap:#f5edd1;   /* Rahmen-Hintergrund */
  --panel:#e6cfa7;  /* Umschlag-K√∂rper */
  --flap:#ecdeb8;   /* Klappe */
  --paper:#ffffff;  /* Briefpapier */
  --text:#444;
  --heart:#fc08e7;
  --shadow:rgba(0,0,0,.2);
  --W:300px;  /* Breite Umschlag */
  --H:230px;  /* H√∂he Umschlag */
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif;
  color:#fff;
}

* { box-sizing: border-box; }
html,body { margin:0; background:#05353d; }
h1 { margin:24px 12px; text-align:center; color:#fff; font-size:clamp(22px,4vw,36px); }

#gift-app .meta{opacity:.85;margin:-6px 0 10px;text-align:center}
#gift-app .list{
  display:flex; flex-wrap:wrap; gap:32px; justify-content:center;
  max-width:1040px; margin:0 auto 28px; padding:0 16px;
}

/* Umschlag-Container: feste Ma√üe, damit Geometrie 100% passt */
#gift-app .env{
  width:var(--W); height:var(--H);
  background:var(--wrap);
  border-radius:12px; padding:10px;
  box-shadow:0 0 20px var(--shadow);
  position:relative; cursor:pointer;
  transition:opacity .25s ease, transform .2s ease;
}
#gift-app .env.disabled { opacity:.35; pointer-events:none; filter:saturate(.3); }

/* Innenleben */
#gift-app .inner{
  position:relative; width:100%; height:100%;
  overflow:hidden;               /* Brief bleibt drin, bis Step 3 */
  perspective:900px;             /* stabiler Flip der Klappe */
}

/* Umschlag-K√∂rper als Rechteck */
#gift-app .panel{
  position:absolute; inset:0; z-index:1;
  background:var(--panel); border-radius:8px;
}

/* Klappe als Dreieck via clip-path (kein border-hack) */
#gift-app .flap{
  position:absolute; left:0; right:0; top:0; height:65%;
  background:var(--flap);
  clip-path:polygon(50% 0%, 100% 100%, 0% 100%);
  transform-origin:50% 0;        /* oben-mittig */
  transform:rotateX(0deg);
  backface-visibility:hidden;
  transition:transform .5s ease; /* Step 1 */
  z-index:3;                     /* √ºber dem Brief, wenn zu */
  will-change:transform;
}

/* Brief ‚Äì √ºber translateY, robuster als bottom */
#gift-app .letter{
  position:absolute; left:50%; bottom:10px;
  width:54%; height:80%;
  transform:translate(-50%, 65%);   /* Start: im Umschlag */
  background:var(--paper); color:var(--text);
  border-radius:8px; padding:12px;
  box-shadow:0 0 5px var(--shadow);
  z-index:2;                        /* unter der Klappe, √ºber dem Panel */
  display:flex; align-items:flex-start; justify-content:flex-start; overflow:hidden;
  transition:transform .65s ease;   /* Step 3 */
}
#gift-app .text{ font-size:12px; line-height:1.35; text-align:left; }

/* Herz in der Mitte */
#gift-app .heart{
  position:absolute; top:50%; left:50%;
  width:22px; height:22px; background:var(--heart);
  transform:translate(-50%,-35%) rotate(45deg);
  transition:transform .35s ease;  /* Step 2 */
  box-shadow:0 1px 6px var(--shadow);
  z-index:4; pointer-events:none;
}
#gift-app .heart::before, #gift-app .heart::after{
  content:""; position:absolute; width:22px; height:22px; background:var(--heart); border-radius:50%;
}
#gift-app .heart::before{ top:-11px; left:0; }
#gift-app .heart::after { left:-11px; top:0; }

/* ===== Schritt-Klassen erzwingen Reihenfolge ===== */
/* Step 1: Klappe */
#gift-app .env.open-s1 .flap{ transform:rotateX(180deg); }
/* Step 2: Herz */
#gift-app .env.open-s2 .heart{ transform:rotate(90deg) translate(0,0); }
/* Step 3: Brief raus + darf herausragen */
#gift-app .env.open-s3 .inner{ overflow:visible; }
#gift-app .env.open-s3 .letter{ transform:translate(-50%, -55%); }

/* Buttons unten */
#gift-app .row{
  display:flex; gap:12px; justify-content:center; align-items:center;
  max-width:1040px; margin:0 auto 24px; padding:0 16px; opacity:.9; font-size:14px;
}
#gift-app .row a, #gift-app .row button{
  padding:10px 14px; border:0; border-radius:10px; font-weight:600;
  cursor:pointer; text-decoration:none;
}
#gift-app .back{ background:#0a5c6d; color:#fff; }
#gift-app .back:hover{ background:#0d768b; }
#gift-app .reset{ background:#f3f4f6; color:#111; }
</style>
</head>
<body>
  <h1>üìú Briefe f√ºr dich</h1>

  <div id="gift-app">
    <div class="meta" id="meta"></div>

    <div class="list" id="list">
      <!-- 1 -->
      <div class="env">
        <div class="inner">
          <div class="panel"></div>
          <div class="flap"></div>
          <div class="letter"><div class="text">üíú Du bist der Beste!</div></div>
          <div class="heart" aria-hidden="true"></div>
        </div>
      </div>
      <!-- 2 -->
      <div class="env">
        <div class="inner">
          <div class="panel"></div>
          <div class="flap"></div>
          <div class="letter"><div class="text">‚ú® Danke f√ºr alles, was du tust!</div></div>
          <div class="heart" aria-hidden="true"></div>
        </div>
      </div>
      <!-- 3 -->
      <div class="env">
        <div class="inner">
          <div class="panel"></div>
          <div class="flap"></div>
          <div class="letter"><div class="text">üåô Ohne dich w√§re alles halb so sch√∂n.</div></div>
          <div class="heart" aria-hidden="true"></div>
        </div>
      </div>
      <!-- 4 -->
      <div class="env">
        <div class="inner">
          <div class="panel"></div>
          <div class="flap"></div>
          <div class="letter"><div class="text">‚≠ê Du machst jeden Tag besser!</div></div>
          <div class="heart" aria-hidden="true"></div>
        </div>
      </div>
      <!-- 5 -->
      <div class="env">
        <div class="inner">
          <div class="panel"></div>
          <div class="flap"></div>
          <div class="letter"><div class="text">ü´∂ Ich bin froh, dass es dich gibt!</div></div>
          <div class="heart" aria-hidden="true"></div>
        </div>
      </div>
    </div>

    <div class="row">
      <a href="index.html" class="back">‚¨Ö Zur√ºck</a>
      <button class="reset" id="reset">Score zur√ºcksetzen</button>
    </div>
  </div>

<script>
  // Score aus Banana-Game (SessionStorage)
  const score = parseInt(sessionStorage.getItem("bananaScore") || "0");
  const envs  = Array.from(document.querySelectorAll("#gift-app .env"));
  const meta  = document.getElementById("meta");
  meta.textContent = `Freigeschaltet: ${Math.min(score, envs.length)} / ${envs.length}`;

  // Freischalten nach Score
  envs.forEach((env, i) => {
    if (i >= score) { env.classList.add("disabled"); return; }

    env.addEventListener("click", () => {
      if (env.classList.contains("open-s3")) {
        env.classList.remove("open-s1","open-s2","open-s3");
        return;
      }
      env.classList.add("open-s1");                  // 1) Klappe
      setTimeout(()=>env.classList.add("open-s2"), 300);  // 2) Herz
      setTimeout(()=>env.classList.add("open-s3"), 700);  // 3) Brief
    });
  });

  // Komfort: Score reset
  document.getElementById("reset").addEventListener("click", ()=>{
    sessionStorage.removeItem("bananaScore");
    location.reload();
  });
</script>
</body>
</html>
